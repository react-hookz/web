import { Example } from './example.stories'
import { ImportPath } from '../../__docs__/ImportPath'
import { ArgsTable, Canvas, Meta, Story } from '@storybook/addon-docs'

<Meta title="Side-effect/useLocalStorageValue" component={Example} />

# useLocalStorageValue

Manages a single LocalStorage key.

- Uses JSON serialisation to handle non-string values.
- Tracks window's `storage` event.
- Synchronized between all hooks on the page with the same key.
- SSR compatible.

> **_This hook provides stable API, meaning the returned methods do not change between renders._**

> Does not allow usage of `null` value, since JSON allows serializing `null` values - it would be
> impossible to separate null value fom 'no such value' API result which is also `null`.

> While using SSR, to avoid hydration mismatch, consider setting `initializeWithValue` option
> to `false` - this will yield `undefined` state on first render and defer value fetching until effects
> are executed.

#### Example

<Canvas isColumn>
  <Story name="Example" story={Example} />
  <hr />
  It also synchronised between hooks on same page
  <hr />
  <Story name="Example2" story={Example} />
</Canvas>

<ArgsTable story="Example" />

## Reference

```ts
function useLocalStorageValue<T>(
  key: string,
  defaultValue: T | null = null,
  options: UseStorageValueOptions<T> = {}
): HookReturn<T, typeof defaultValue, typeof options>;
```

#### Importing

<ImportPath />


#### Arguments

- **key** _`string`_ - LocalStorage key to manage.
- **options** _`object`_ - Hook options:
  - **defaultValue** _`T | null`_ - Value to return if `key` is not present in LocalStorage.
  - **initializeWithValue** _`boolean`_ _(default: true)_ - Fetch storage value on first render. If
    set to `false` will make the hook yield `undefined` on first render and defer fetching of the
    value until effects are executed.

#### Return

0. **value** - LocalStorage value of the given `key` argument or `defaultValue`, if the key was not
present.
1. **set** - Method to set a new value for the managed `key`.
2. **remove** - Method to remove the current value of `key`.
3. **fetch** - Method to manually retrieve the value of `key`.
